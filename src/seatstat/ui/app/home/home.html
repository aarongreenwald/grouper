<div class="col-md-2"></div>
<div ng-controller="HomeCtrl" class="container col-md-8">            
    <div ng-if="home.step === 0">
        <div class="step-header">Students</div>
        
        <div class="row" style="max-width:800px">
            <div ng-repeat="member in home.members" class="member-name">
                <span class="member-name" >
                    <input class="member-name" ng-model="member.name" 
                        ng-change="home.memberChange($index)" ng-blur="home.memberBlur($index)"
                        ng-class="{'duplicate': home.duplicateMember(member)}"/>
                </span>                
            </div>            
        </div>        
    </div>        
    <div ng-if="home.step === 1">
        <div class="step-header">Classroom Setup</div>
        <div class="row">
            Divide {{home.members.length - 1}} students into            
                <input class="group-size" min="2" ng-model="home.groupCount" ng-change="home.groupCountChanged()" type="number"/>  tables.                
        </div>
        <div class="home-table-setup" ng-repeat="group in home.groupSizes">
            <span><input ng-model="group.size" type="number" /></span>
        </div>
    </div>
    <div ng-if="home.step === 2">
        <div class="step-header">Restrictions</div>
        <div class="row">
            <div class="col-sm-6">                            
                <table ng-show="home.restrictions.length">
                    <tbody>
                        <tr ng-repeat="pair in home.restrictions" >
                            <td class="pair-item"><div>{{pair[0]}}</div></td>                            
                            <td class="pair-item"><div ng-show="pair[1].length">{{pair[1]}}</div></td>
                            <td><span ng-click="home.removeRestriction($index)" title="Remove" class="glyphicon glyphicon-remove icon-button"/></td>
                        </tr>
                    </tbody>
                </table>
                <div ng-show="!home.restrictions.length">
                    You have no restrictions on placement. Start by clicking on the names on the right to add
                    pairs  of students that cannot sit together.
                </div>                                
            </div> 
            <div class="col-sm-6">                
                <div ng-repeat="member in home.members" ng-click="home.addToRestriction(member)" 
                    class="restriction-member"
                    ng-class="{'invalid': !home.validInRestriction(member)}">{{member.name}}</div>                
            </div>
        </div>
    </div>
    <div ng-if="home.step === 3">
        <div class="row">
            <div class="col-xs-12">
                <div ng-repeat="group in home.groups" class="group">
                    <div class="group-header">Table {{$index + 1}} </div>
                    <div class="group-member" ng-repeat="member in group">{{member}}</div>        
                </div> 
            </div>
        </div>        
    </div>     
    <div class="row" style="margin-top:25px;">
        <div class="pull-left">
            <button ng-if="home.step === 3" class="btn btn-default btn-sm" ng-click="home.step = 0">Start Over</button>  
            <button ng-if="home.step !== 0" class="btn btn-default btn-sm" ng-click="home.step = home.step - 1">Back</button>  
        </div>
        <div class="pull-right">
            <button ng-if="home.step < 2 " class="btn btn-default btn-sm" ng-click="home.step = home.step + 1">Next</button>                    
            <button ng-if="home.step === 2" class="btn btn-default btn-sm" ng-click="home.generateGroups()">Next</button>                    
        </div>        
    </div>   
</div>
<style>
    div.step-header{
        font-size:large;
    }
    div.member-name{
        margin:10px;
    }
    span.member-name {
        padding:5px;        
        float:left;
    }
    input.member-name.duplicate {
        box-shadow: 0px 0px 3px .5px rgba(255, 0, 0, 1);
    }
   
    input.group-size {
        width:40px;
    }
    .group {
        float: left;
        margin: 20px;
        border: 1px solid gray;
        border-radius: 4px;
        width: 150px;
    }
    
    .group-header{        
        font-weight: bold;
        border-bottom: 1px solid gray;
        background: rgba(211, 211, 211, 0.37);
        text-align: center;
        padding:4px;
    }
    .group-member{
        margin-left:7px;
    }
    td.pair-item{     
        padding:7px 15px;
    }   
    td.pair-item > div{        
        border: 1px solid rgba(128, 128, 128, 0.65);
        padding: 5px;
        border-radius: 3px;      
        min-width:125px;
        background-color: rgba(160, 153, 153, 0.22 );
    }
    .icon-button{
        cursor:pointer;
        opacity:.6;
    }
    .icon-button:hover{
        opacity:.9;
    }
    .restriction-member{
        padding:5px;
        float:right;
        width:150px;               
    }
    
   @media only screen and (min-device-width : 768px) {
        .restriction-member{
            float:left !important;
        }    
    }
     .restriction-member:not(.invalid):hover{
        cursor:pointer; 
        color:blue;        
    }
    .restriction-member.invalid{
        opacity:.3;
    }
    
</style>
